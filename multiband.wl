(* ::Package:: *)

Hmb[a_?NumberQ,\[Mu]0_?NumberQ,\[CapitalDelta]0_?NumberQ,V0_?NumberQ,\[Alpha]0_?NumberQ,dim_?IntegerQ]:=Block[{t=25/a^2,\[Mu]=\[Mu]0,\[Alpha]=\[Alpha]0/(2a),Vz=V0,\[CapitalDelta]11=\[CapitalDelta]0,\[CapitalDelta]12=\[CapitalDelta]0,H11,H12,H22,\[Epsilon]=1},H11=KroneckerProduct[PauliMatrix[3],KroneckerProduct[PauliMatrix[0],-t*(SparseArray[{Band[{1,2}]->1,Band[{2,1}]->1},{dim,dim}])+(-\[Mu]+2*t)IdentityMatrix[dim,SparseArray]]+KroneckerProduct[PauliMatrix[2],I*\[Alpha]*(SparseArray[{Band[{1,2}]->-1,Band[{2,1}]->1},{dim,dim}])]]+KroneckerProduct[PauliMatrix[0],KroneckerProduct[PauliMatrix[3],Vz*IdentityMatrix[dim,SparseArray]]]+KroneckerProduct[PauliMatrix[1],KroneckerProduct[PauliMatrix[0],\[CapitalDelta]11*IdentityMatrix[dim,SparseArray]]];H22=KroneckerProduct[PauliMatrix[3],KroneckerProduct[PauliMatrix[0],-t*(SparseArray[{Band[{1,2}]->1,Band[{2,1}]->1},{dim,dim}])+(\[Epsilon]-\[Mu]+2*t)IdentityMatrix[dim,SparseArray]]+KroneckerProduct[PauliMatrix[2],I*\[Alpha]*(SparseArray[{Band[{1,2}]->-1,Band[{2,1}]->1},{dim,dim}])]]+KroneckerProduct[PauliMatrix[0],KroneckerProduct[PauliMatrix[3],Vz*IdentityMatrix[dim,SparseArray]]]+KroneckerProduct[PauliMatrix[1],KroneckerProduct[PauliMatrix[0],\[CapitalDelta]11*IdentityMatrix[dim,SparseArray]]];H12=KroneckerProduct[PauliMatrix[1],KroneckerProduct[PauliMatrix[0],\[CapitalDelta]12*IdentityMatrix[dim,SparseArray]]];Chop@ArrayFlatten[{{H11,H12},{H12,H22}}]]


Hmbp[\[Mu]0_,\[CapitalDelta]0_,\[Alpha]0_,V0_]:=Block[{H11,H12,H22,H,Hmb22,Hmb11,Hmb12,\[Eta]=25,k,\[Mu]=\[Mu]0,V=V0,\[Alpha]=\[Alpha]0,\[CapitalDelta]=\[CapitalDelta]0,\[CapitalDelta]c=.2,Hp,\[Epsilon]=0,sl,u=.5},H11=(\[Eta] k^2 -\[Mu])*IdentityMatrix[2]+V PauliMatrix[3]-\[Alpha] k PauliMatrix[2];H12=\[CapitalDelta] IdentityMatrix[2];H22=-(\[Eta] k^2 -\[Mu])*IdentityMatrix[2]+V PauliMatrix[3]+\[Alpha] k PauliMatrix[2];H=ArrayFlatten[{{H11,H12},{H12,H22}}];Hmb22=ArrayFlatten[{{(\[Eta] k^2 -(\[Mu]-\[Epsilon]))*IdentityMatrix[2]+V PauliMatrix[3]-\[Alpha] k PauliMatrix[2],\[CapitalDelta] IdentityMatrix[2]},{\[CapitalDelta] IdentityMatrix[2],-(\[Eta] k^2 -(\[Mu]-\[Epsilon]))*IdentityMatrix[2]+V PauliMatrix[3]+\[Alpha] k PauliMatrix[2]}}];Hmb11=H;Hmb12=KroneckerProduct[PauliMatrix[1],IdentityMatrix[2]]\[CapitalDelta]c;Hp=ArrayFlatten[{{Hmb11,Hmb12},{Hmb12,Hmb22}}];sl=Eigenvalues[Hp];ListLinePlot[Transpose@Table[sl,{k,-u,u,.01}],DataRange->{-u,u},PlotRange->{{-u,u},{0,2}},PlotStyle->{Blue,LightBlue,Red,LightRed},PlotLabel->sl[[5]]/.k->0]]
